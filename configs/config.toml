lanip = ''
serverid = 'local'
wanip = ''

[base]
disabledcaptcha = true
jwtsecret = ''
timeout = 0

[baselog]
dir = './logs'
level = 'info'
maxage = 2678400
rotationsize = 50
rotationtime = 28800

[data]
connmaxlifetime = 21600
dsn = './configs/data.db'
maxidleconns = 1
maxopenconns = 1
slowthreshold = 200

[defaulthttpconfig]
httplistenaddr = ':5066'
httpscertfile = './configs/cert.pem'
httpskeyfile = './configs/key.pem'
httpslistenaddr = ':24434'

[lalconfig]
httplistenaddr = ":8080"
httpslistenaddr = ""
httpscertfile = "./conf/cert.pem"
httpskeyfile = "./conf/key.pem"

[gopcacheconfig]
gopnum = 0
singlegopmaxframenum = 200

[hlsconfig]
boundarybyvideo = true
cleanupmode = 2
deletethreshold = 2
enable = true
enablehttps = false
fragmentdurationms = 6000
fragmentnum = 5
outpath = './stream/hls/'
subsessionhashkey = ''
subsessiontimeoutms = 20000
urlpattern = '/hls/'
usem3u8memoryflag = false
usememoryasdiskflag = false

[hlsconfig.fmp4]
enable = false
enablehttps = false
urlpattern = '/hls/m4s/*streamname'

[httpapiconfig]
enable = true

[httpflvconfig]
enable = true
enablehttps = false
urlpattern = '/'

[httpfmp4config]
enable = false
enablehttps = false
urlpattern = '/m4s/live/:streamname.mp4'

[httptsconfig]
enable = false
enablehttps = false
urlpattern = '/ts/live/:streamname'

[insessionconfig]
adddummyaudioenable = true
adddummyaudiowaitaudioms = 150

[logconfig]
assertbehavior = 1
filename = './logs/sugar.log'
isrotatedaily = true
istostdout = true
level = 4
levelflag = true
shortfileflag = true
timestampflag = true
timestampwithmsflag = true

[recordconfig]
enableflv = false
enablefmp4 = false
enablempegts = false
flvoutpath = './streamsvr_record/flv/'
fmp4outpath = './streamsvr_record/fmp4'
mpegtsoutpath = './r/'

[relaypush]
addrlist = []
enable = false

[roomconfig]
apikey = 'admin@admin'
apisecret = 'admin@admin'
enable = true

[rtcconfig]
enable = true
enablehttps = true
icehostnattoips = ['192.168.3.107']
icetcpmuxport = 24888
iceudpmuxport = 24888
pubtimeoutsec = 10
urlpattern = '/live/:streamname'

[rtmpconfig]
addr = ':21935'
enable = true
mergewritesize = 0
pubtimeoutsec = 0
pulltimeoutsec = 30
rtmpoverquicaddr = ':25935'
rtmpoverquicenable = true
rtmpsaddr = ':24935'
rtmpscertfile = './configs/cert.pem'
rtmpsenable = true
rtmpskeyfile = './configs/key.pem'

[rtspconfig]
addr = ':15544'
authenable = false
authmethod = 1
enable = true
outwaitkeyframeflag = true
password = 'admin'
pubtimeoutsec = 0
pulltimeoutsec = 30
rtspsaddr = ':5322'
rtspscertfile = './configs/cert.pem'
rtspsenable = true
rtspskeyfile = './configs/key.pem'
username = 'admin'
wsrtspaddr = ':25566'
wsrtspenable = true

[srtconfig]
addr = ':6000'
enable = false
encryptenable = false
encryptmode = 2
passphrase = 'streamsvr-password'
pubtimeoutsec = 0

[staticrelaypull]
addr = ''
enable = false

[storage]
bucket = ''
concurrency = 8
days = 3
diskusageratio = 85.95
enabledcloudstorage = false
endpoint = ''
format = 'mp4'
fragmentdurations = 20
key = ''
path = './r'
queuelength = 512
region = ''
retry = 0
secret = ''
timeout = 30000

[vodconfig]
dir = 'vod_data/vod'
srcdir = 'vod_data/vodsrc'
systrannumber = 3
progressnotifyurl = ""
hlstime = 8
opensquare = true
opendefinition = false
defaultdefinition = 'hd'
transdefinition = 'sd,hd,fhd'
transvideo = false
tranway = 'libx264'
tranhevcway = 'copy'

[frame_extractor]
enable = false
interval_ms = 1000
output_dir = './snapshots'
store = 'local' # local|minio
# 任务类型列表，用于智能分析分类
task_types = ['人数统计', '人员跌倒', '人员离岗', '吸烟检测', '区域入侵', '徘徊检测', '物品遗留', '安全帽检测']

[frame_extractor.minio]
endpoint = '10.1.6.230:9000'
bucket = 'images'
access_key = 'admin'
secret_key = 'admin123'
use_ssl = false
base_path = ''

[[frame_extractor.tasks]]
id = '客流分析1'
task_type = '人数统计'  # 任务类型，对应task_types中的一项
rtsp_url = 'rtsp://127.0.0.1:15544/live/stream_1'
interval_ms = 5000
output_path = '客流分析1'
enabled = true

[ai_analysis]
enable = false  # 启用智能分析插件
scan_interval_sec = 10  # MinIO扫描间隔（秒）
mq_type = 'kafka'  # 消息队列类型：kafka|rabbitmq
mq_address = 'localhost:9092'  # 消息队列地址
mq_topic = 'easydarwin.alerts'  # 告警推送topic
heartbeat_timeout_sec = 90  # 算法服务心跳超时（秒）
max_concurrent_infer = 5  # 最大并发推理任务数
