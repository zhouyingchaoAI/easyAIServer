# 线条方向配置 - 快速指南

## 🎯 三种检测方向

### 1️⃣ ← 左到右 → (left_to_right)
```
════════════════════════→
    起点              终点
                     ↑ 箭头
```
**用途**: 单向进入检测
**示例**: 商场入口、收费站进口、上班通道

---

### 2️⃣ → 右到左 ← (right_to_left)
```
←════════════════════════
起点              终点
↑ 箭头
```
**用途**: 单向离开检测  
**示例**: 商场出口、收费站出口、下班通道

---

### 3️⃣ ↔ 双向统计 ↔ (bidirectional)
```
←═══════════════════════→
起点   ↑箭头    ↑箭头   终点
```
**用途**: 双向统计
**示例**: 双向车道、通用通道、客流分析

---

## 🚀 5步快速配置

```
┌─────────────────────────────────────────┐
│  1. 打开算法配置                         │
│     ↓                                    │
│  2. 点击"绘制线"按钮                     │
│     ↓                                    │
│  3. 画布上点击起点和终点                 │
│     ↓                                    │
│  4. 在右侧配置面板选择检测方向           │
│     ↓                                    │
│  5. 保存配置                             │
└─────────────────────────────────────────┘
```

---

## 💡 常见场景配置

### 场景A: 商场入口/出口
```
     入口              |              出口
  ← 左到右 →          |          → 右到左 ←
══════════════        |        ══════════════
   检测进入           |           检测离开
```

### 场景B: 双向通道
```
          ↔ 双向统计 ↔
    ←═══════════════════════→
      同时统计两个方向
```

### 场景C: 禁行区域
```
    合法区域     |    禁行区域
                |
    ════════→  |  (单向检测)
                |
      只检测非法进入
```

### 场景D: 多通道监控
```
   通道1: ← 左到右 →  (上班)
   
   通道2: → 右到左 ←  (下班)
   
   通道3: ↔ 双向 ↔    (通用)
```

---

## 📋 配置面板说明

```
┌──────────────────────────────────┐
│ 区域配置                          │
├──────────────────────────────────┤
│ □ 线_1                    [启用] │
│   ┌────────────────────────────┐ │
│   │ 区域名称: _______________  │ │
│   │ 区域类型: 线 (不可改)      │ │
│   │ 颜色:     [●]              │ │
│   │ 透明度:   ▓▓▓▓▓▓▓░░░  0.7 │ │
│   │ 检测方向: [← 左到右 →]     │ │  👈 这里选择方向
│   │          ▼                 │ │
│   │          ├ ← 左到右 →      │ │
│   │          ├ → 右到左 ←      │ │
│   │          └ ↔ 双向统计 ↔    │ │
│   │                            │ │
│   │ 💡 箭头将在线上显示方向    │ │
│   └────────────────────────────┘ │
│   [删除此区域]                   │
└──────────────────────────────────┘
```

---

## ⚙️ 方向选项对比

| 方向选项 | 图标 | 箭头位置 | 检测目标 | 适用场景 |
|---------|------|---------|---------|---------|
| 左到右 | ← → | 3/4处→ | 起→终 | 进入检测 |
| 右到左 | → ← | 1/4处← | 终→起 | 离开检测 |
| 双向 | ↔ ↔ | 1/4←和3/4→ | 双向 | 流量统计 |

---

## 🎨 视觉效果示例

### 画布上的显示

```
绘制完成后:

     起点 ●─────────────────●→ 终点
                          ↑
                    红色三角箭头
                  (颜色与线条同步)
```

### 方向切换效果

```
默认 (左到右):
    ●─────────────────●→

切换为 (右到左):
    ●←─────────────────●

切换为 (双向):
    ●←────────────────●→
```

---

## 🔧 快速操作技巧

### 绘制技巧
✅ **DO**
- 从画面左侧向右侧绘制（保持一致）
- 确保线条穿过检测区域中心
- 预留足够的检测距离

❌ **DON'T**
- 不要画太短的线（建议>100像素）
- 不要在画面边缘绘制
- 不要重叠多条检测线

### 配置技巧
1. **先绘制后配置**: 画好所有线后统一配置方向
2. **颜色区分**: 不同方向使用不同颜色
3. **命名规范**: 使用有意义的名称（如"入口_左到右"）

---

## ⚡ 常见问题

### Q1: 箭头看不见？
```
检查项:
☑ 线条颜色是否太浅
☑ 是否与背景颜色冲突
☑ 画布缩放比例是否正常
☑ 浏览器是否支持Fabric.js
```

### Q2: 方向搞反了？
```
解决方案:
方案1: 重新配置方向（推荐）
方案2: 删除后重新绘制
方案3: 调整起点和终点的理解
```

### Q3: 箭头没有更新？
```
排查步骤:
1. 检查是否保存了配置
2. 刷新页面重新加载
3. 检查浏览器控制台错误
4. 联系技术支持
```

### Q4: 方向与实际不符？
```
原因:
• "左右"是相对于绘制方向，非画面方向
• 起点=左，终点=右

建议:
• 统一从画面左侧向右侧绘制
• 使用"进入/离开"代替"左右"理解
```

---

## 🎯 最佳实践

### 1. 命名规范
```
✅ 好的命名:
  - "入口_进入检测"
  - "出口_离开检测"  
  - "主通道_双向统计"

❌ 差的命名:
  - "线_1"
  - "line"
  - "test"
```

### 2. 颜色选择
```
建议配色方案:
  - 进入检测: 绿色 #00FF00
  - 离开检测: 红色 #FF0000
  - 双向统计: 蓝色 #0000FF
  - 禁行检测: 橙色 #FFA500
```

### 3. 布局建议
```
单通道:
  ┌────────────┐
  │            │
  │    ────→   │  (居中绘制)
  │            │
  └────────────┘

多通道:
  ┌────────────┐
  │  ←────     │  (通道1)
  │            │
  │    ────→   │  (通道2)
  │            │
  │      ↔     │  (通道3)
  └────────────┘
```

---

## 📊 数据格式参考

保存的配置JSON结构:
```json
{
  "task_id": "task_123",
  "regions": [
    {
      "id": "region_1698765432000",
      "name": "入口_进入检测",
      "type": "line",
      "enabled": true,
      "points": [[100, 200], [400, 300]],
      "properties": {
        "color": "#00FF00",
        "thickness": 3,
        "direction": "left_to_right"  👈 方向字段
      }
    }
  ],
  "algorithm_params": {
    "confidence_threshold": 0.7,
    "iou_threshold": 0.5
  }
}
```

---

## 📞 需要帮助?

### 查看详细文档
- `LINE_DIRECTION_FEATURE.md` - 完整功能说明
- `LINE_DIRECTION_IMPLEMENTATION_SUMMARY.md` - 技术实现

### 在线资源
- 项目文档: [EasyDarwin文档]
- 源代码: `web-src/src/components/AlgoConfigModal/index.vue`

---

## 版本信息

- **版本**: v1.0
- **更新时间**: 2025-10-20
- **兼容性**: ✅ 完全兼容现有配置

---

**快速记忆口诀:**

```
📝 画线选方向，箭头显画布
📝 左到右进入，右到左离开
📝 双向全统计，配置超简单
```

---

## 键盘图例

```
符号说明:
  →  向右箭头
  ←  向左箭头
  ↔  双向箭头
  ●  端点
  ═  检测线
  ▓  进度条
  ☑  已选中
  ☐  未选中
  ✅  推荐
  ❌  不推荐
```

