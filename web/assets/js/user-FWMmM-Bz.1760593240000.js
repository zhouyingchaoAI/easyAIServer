import{d}from"./pinia-V2a9_C2l.1760593240000.js";import{r as n}from"./request-DfXCiAj6.1760593240000.js";import{u as f}from"./vue-router-Dt8r6qAa.1760593240000.js";import{s as w,r as h}from"./index-BFAyM4J0.1760593240000.js";import{C as u}from"./crypto-js-BIwZBnoR.1760593240000.js";import{r as S,f as v}from"./vue-DcFgi5qX.1760593240000.js";const a={changePassword(s,t){return n({url:`/users/${s}/reset-password`,method:"put",data:t})},userLogin(s){return n({url:"/login",method:"post",data:s})},userLogout(s){return n({url:"/logout",method:"post",data:s})}},U=d("user",()=>{const s=S({}),t=r=>{s.value=r},i=f(),l=async r=>new Promise((p,o)=>{a.userLogin({...r,password:u.SHA256(r.password).toString()}).then(e=>{e.status==200?(i.push("/"),console.log("res.data.user",e),t(e.data),w(e.data.token)):o()}).catch(e=>{o(e)})}),c=async()=>{(await a.userLogout()).status==200&&(i.push("/login"),s.value={},h())},g=r=>new Promise((p,o)=>{a.changePassword(m.value,{password:u.SHA256(r.password).toString(),new_password:u.SHA256(r.new_password).toString()}).then(e=>{e.status==200?p():o()}).catch(e=>{o()})}),m=v(()=>s.value&&s.value.username?s.value.username:"empty");return{userInfo:s,setUserInfo:t,login:l,logout:c,changePassword:g,getUsername:m}},{persist:!0});export{U as u};
