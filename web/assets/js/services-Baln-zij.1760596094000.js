import"./request-CoWACYU5.1760596094000.js";import{a as I}from"./alert-CCcApqaQ.1760596094000.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.1760596094000.js";import{m as V,k as L,a1 as M,T as z,t as E,a6 as F,a2 as H,B as O}from"./ant-design-vue-D8I8zMbk.1760596094000.js";import{N as j,ac as J}from"./@ant-design-Xil9Y0Mc.1760596094000.js";import{r as g,j as P,Z as m,c as l,X as a,W as s,V as p,a1 as h,J as i,a3 as u,F as y,_ as R,u as w,$ as W}from"./vue-DcFgi5qX.1760596094000.js";import"./axios-ngrFHoWO.1760596094000.js";import"./qs-m7ADN_Ca.1760596094000.js";import"./clipboard-DnI0MzOy.1760596094000.js";import"./side-channel-7ObsPEGz.1760596094000.js";import"./crypto-js-BptWzl5V.1760596094000.js";import"./index-DKAquY-M.1760596094000.js";import"./vue-i18n-D34mLbx9.1760596094000.js";import"./@intlify-C7-MzqOv.1760596094000.js";import"./nprogress-CSkLUarA.1760596094000.js";/* empty css                                  */import"./dayjs-7sxDqJU0.1760596094000.js";import"./pinia-DDAUOP-W.1760596094000.js";import"./pinia-plugin-persistedstate-n2tMOXAx.1760596094000.js";import"./vue-router-wJF_rOwP.1760596094000.js";import"./lodash-es-C9rdhAyu.1760596094000.js";import"./@iconify-CZ5U7IZZ.1760596094000.js";import"./@babel-Bq4_u9L9.1760596094000.js";import"./@ctrl-DOFZgDuz.1760596094000.js";import"./resize-observer-polyfill-B1PUzC5B.1760596094000.js";import"./dom-align-CRCehRfe.1760596094000.js";import"./async-validator-9PlIezaS.1760596094000.js";import"./scroll-into-view-if-needed-B3z4cY-J.1760596094000.js";import"./throttle-debounce-CUWDS_la.1760596094000.js";import"./vue-types-CF28atMM.1760596094000.js";import"./@emotion-BtrR-yrm.1760596094000.js";import"./stylis-D5iaQeiq.1760596094000.js";const X={class:"p-4 services-container"},Y={class:"card-title"},Z={__name:"services",setup($){const _=g(!1),d=g([]),b=[{title:"服务ID",key:"service_id",width:200},{title:"服务名称",key:"name",width:200},{title:"支持的任务类型",key:"task_types",width:300},{title:"推理端点",key:"endpoint",ellipsis:!0},{title:"版本",key:"version",width:100},{title:"状态",key:"status",width:120},{title:"注册时间",key:"register_at",width:180},{title:"最后心跳",key:"last_heartbeat",width:180}],f=async()=>{_.value=!0;try{const{data:t}=await I.listServices();d.value=(t==null?void 0:t.services)||[]}catch(t){console.error("fetch services failed",t),L.error("加载算法服务列表失败")}finally{_.value=!1}},S=t=>{const e=Math.floor(Date.now()/1e3),n=t.last_heartbeat||0,o=e-n;return o<90?"success":o<180?"warning":"error"},x=t=>{const e=Math.floor(Date.now()/1e3),n=t.last_heartbeat||0,o=e-n;return o<90?"正常":o<180?"心跳超时":"已失联"},k=t=>t?new Date(t*1e3).toLocaleString("zh-CN"):"-";return P(()=>{f(),setInterval(f,3e4)}),(t,e)=>{const n=O,o=z,B=E,N=F,A=M,C=H,D=V;return s(),m("div",X,[l(D,{bordered:!1,class:"services-card"},{title:a(()=>[W("span",Y,[l(w(J),{class:"title-icon"}),e[0]||(e[0]=i(" 注册的算法服务 ",-1))])]),extra:a(()=>[l(n,{onClick:f,size:"small"},{icon:a(()=>[l(w(j))]),default:a(()=>[e[1]||(e[1]=i(" 刷新 ",-1))]),_:1})]),default:a(()=>[l(A,{"data-source":d.value,columns:b,loading:_.value,"row-key":"service_id",pagination:!1},{bodyCell:a(({column:c,record:r})=>[c.key==="service_id"?(s(),p(o,{key:0,color:"blue"},{default:a(()=>[i(u(r.service_id),1)]),_:2},1024)):c.key==="task_types"?(s(),p(B,{key:1},{default:a(()=>[(s(!0),m(y,null,R(r.task_types,v=>(s(),p(o,{key:v,color:"purple"},{default:a(()=>[i(u(v),1)]),_:2},1024))),128))]),_:2},1024)):c.key==="status"?(s(),p(N,{key:2,status:S(r),text:x(r)},null,8,["status","text"])):c.key==="register_at"?(s(),m(y,{key:3},[i(u(k(r.register_at)),1)],64)):c.key==="last_heartbeat"?(s(),m(y,{key:4},[i(u(k(r.last_heartbeat)),1)],64)):h("",!0)]),_:1},8,["data-source","loading"]),d.value.length===0&&!_.value?(s(),p(C,{key:0,message:"暂无算法服务注册",description:"算法服务需要主动调用API注册到EasyDarwin。参考文档：doc/AI_ANALYSIS.md",type:"info","show-icon":"",class:"mt-4"})):h("",!0)]),_:1})])}}},At=T(Z,[["__scopeId","data-v-6d690621"]]);export{At as default};
